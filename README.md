# 四校数学成绩分析系统

一个基于React + TypeScript的Web应用，专门用于分析四校联考数学成绩数据，支持Excel文件导入导出、PDF报告生成和可视化分析。

## 功能特性

- 📊 **Excel文件导入**：支持.xlsx和.xls格式的四校联考成绩文件
- ⚙️ **灵活配置**：支持自定义学科、满分、及格线、优秀线等分析参数
- 📈 **多维度数据分析**：学校统计、班级统计、学生个人统计
- 🏫 **学校排名分析**：各学校平均分、及格率、优秀率对比
- 📚 **班级排名分析**：各班级校内排名和总排名
- 👥 **学生成绩管理**：联考排名、校内排名、详细成绩展示
- 📊 **可视化图表**：学校对比图、班级对比图、成绩分布图
- 📤 **多格式导出**：支持Excel和PDF格式报告导出
- 🎨 **现代化UI**：基于Ant Design的美观界面

## 技术栈

- **前端框架**：React 18 + TypeScript
- **构建工具**：Vite
- **UI组件库**：Ant Design
- **图表库**：Recharts
- **Excel处理**：SheetJS (xlsx)
- **PDF生成**：jsPDF + html2canvas

## 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

应用将在 http://localhost:3000 启动

### 构建生产版本

```bash
npm run build
```

## 使用说明

### 1. 配置分析参数

- 点击"分析配置"标签页
- 选择预设配置（如"九年级数学"）或自定义参数
- 设置学科名称、年级、满分、及格线、优秀线等

### 2. 上传Excel文件

- 点击"文件上传"标签页
- 拖拽或点击上传Excel文件
- 系统会根据配置自动解析文件内容

### 3. 文件格式要求

Excel文件应包含以下列（第一行为表头）：

- **学校列**：包含"学校"或"校名"
- **考号列**：包含"考号"、"学号"或"学生编号"
- **班级列**：包含"班级"或"班别"
- **姓名列**：包含"姓名"、"名字"或"学生姓名"
- **成绩列**：数学等科目成绩
- **排名列**：校内名次、联考名次等

示例格式：
```
学校                          考号        班级      姓名    数学    校内名次  联考名次
广州市第一一三中学陶育实验学校  2023040309  九年级3班  黄峻杰   116     1        1
广州市华颖外国语学校          2023010214  九年级2班  李林君   116     1        1
广州市天河中学猎德实验学校    2023020234  九年级2班  张嘉森   114     1        3
```

### 4. 查看分析结果

- **数据分析**：查看总体统计、学校对比、班级对比和成绩分布
- **成绩表格**：查看详细的学生成绩、联考排名和校内排名

### 5. 导出结果

点击右上角"导出报告"按钮，选择导出格式：

**Excel格式**包含：
- 学生成绩表（联考排名、校内排名、学校、班级、姓名、考号、成绩）
- 学校统计表（学校排名、学生人数、班级数、平均分、及格率、优秀率）
- 班级统计表（总排名、校内排名、学校、班级、平均分、及格率、优秀率）
- 科目统计表（平均分、最高分、最低分、及格率、优秀率）

**PDF格式**包含：
- 总体统计概览
- 各学校统计表格
- 各班级统计表格
- 科目统计表格

## 项目结构

```
src/
├── components/          # React组件
│   ├── FileUpload.tsx   # 文件上传组件
│   ├── AnalysisDashboard.tsx  # 数据分析面板
│   ├── StudentTable.tsx # 学生成绩表格
│   ├── SubjectChart.tsx # 科目对比图表
│   ├── ClassChart.tsx   # 班级对比图表
│   └── ScoreDistributionChart.tsx # 成绩分布图表
├── types/              # TypeScript类型定义
│   └── index.ts
├── utils/              # 工具函数
│   └── excelUtils.ts   # Excel处理工具
├── App.tsx             # 主应用组件
├── main.tsx            # 应用入口
└── index.css           # 全局样式
```

## 开发说明

### 添加新的图表类型

1. 在`src/components/`目录下创建新的图表组件
2. 在`AnalysisDashboard.tsx`中引入并使用
3. 确保组件接收正确的props类型

### 扩展Excel解析功能

1. 修改`src/utils/excelUtils.ts`中的`parseStudentData`函数
2. 更新`src/types/index.ts`中的类型定义
3. 确保向后兼容性

### 自定义样式

- 全局样式：修改`src/index.css`
- 组件样式：修改`src/App.css`
- 或使用Ant Design的主题定制功能

## 浏览器支持

- Chrome (推荐)
- Firefox
- Safari
- Edge

## 许可证

MIT License
